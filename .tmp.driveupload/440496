module.exports=[58146,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getClientReferenceManifest:function(){return q},getServerActionsManifest:function(){return r},getServerModuleMap:function(){return s},selectWorkerForForwarding:function(){return n},setManifestsSingleton:function(){return o}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(50640),g=a.r(5847),h=a.r(39481),i=a.r(61601),j=a.r(56704),k=Symbol.for("next.server.manifests"),l=globalThis;function m(a){return(0,h.pathHasPrefix)(a,"app")?a:"app"+a}function n(a,b){var c,d;let e=null==(c=r().node[a])?void 0:c.workers;if(e&&!e[m(b)])return d=Object.keys(e)[0],(0,g.normalizeAppPath)((0,i.removePathPrefix)(d,"app"))}function o({page:a,clientReferenceManifest:b,serverActionsManifest:c}){let d=l[k];if(d)d.clientReferenceManifestsPerRoute.set((0,g.normalizeAppPath)(a),b),d.serverActionsManifest=c;else{let d,e=new Map([[(0,g.normalizeAppPath)(a),b]]),h=(d=new Map,new Proxy({},{get(a,b){let c=j.workAsyncStorage.getStore();switch(b){case"moduleLoading":case"entryCSSFiles":case"entryJSFiles":{if(!c)throw Object.defineProperty(new f.InvariantError(`Cannot access "${b}" without a work store.`),"__NEXT_ERROR_CODE",{value:"E952",enumerable:!1,configurable:!0});let a=e.get(c.route);if(!a)throw Object.defineProperty(new f.InvariantError(`The client reference manifest for route "${c.route}" does not exist.`),"__NEXT_ERROR_CODE",{value:"E951",enumerable:!1,configurable:!0});return a[b]}case"clientModules":case"rscModuleMapping":case"edgeRscModuleMapping":case"ssrModuleMapping":case"edgeSSRModuleMapping":{let a=d.get(b);!a&&(a=new Proxy({},{get(a,c){let d=j.workAsyncStorage.getStore();if(d){let a=e.get(d.route);if(null==a?void 0:a[b][c])return a[b][c]}else for(let a of e.values()){let d=a[b][c];if(void 0!==d)return d}}}),d.set(b,a));return a}default:throw Object.defineProperty(new f.InvariantError(`This is a proxied client reference manifest. The property "${String(b)}" is not handled.`),"__NEXT_ERROR_CODE",{value:"E953",enumerable:!1,configurable:!0})}}}));l[k]={clientReferenceManifestsPerRoute:e,proxiedClientReferenceManifest:h,serverActionsManifest:c,serverModuleMap:new Proxy({},{get:(a,b)=>{var c,d;let e,f=null==(d=r().node)||null==(c=d[b])?void 0:c.workers;if(!f)return;let g=j.workAsyncStorage.getStore();if(!(e=g?f[m(g.page)]:Object.values(f).at(0)))return;let{moduleId:h,async:i}=e;return{id:h,name:b,chunks:[],async:i}}})}}}function p(){let a=l[k];if(!a)throw Object.defineProperty(new f.InvariantError("The manifests singleton was not initialized."),"__NEXT_ERROR_CODE",{value:"E950",enumerable:!1,configurable:!0});return a}function q(){return p().proxiedClientReferenceManifest}function r(){return p().serverActionsManifest}function s(){return p().serverModuleMap}},49126,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});var e={arrayBufferToString:function(){return i},decrypt:function(){return l},encrypt:function(){return k},getActionEncryptionKey:function(){return m},stringToUint8Array:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(50640),h=a.r(58146);function i(a){let b=new Uint8Array(a),c=b.byteLength;if(c<65535)return String.fromCharCode.apply(null,b);let d="";for(let a=0;a<c;a++)d+=String.fromCharCode(b[a]);return d}function j(a){let b=a.length,c=new Uint8Array(b);for(let d=0;d<b;d++)c[d]=a.charCodeAt(d);return c}function k(a,b,c){return crypto.subtle.encrypt({name:"AES-GCM",iv:b},a,c)}function l(a,b,c){return crypto.subtle.decrypt({name:"AES-GCM",iv:b},a,c)}async function m(){if(d)return d;let a=(0,h.getServerActionsManifest)(),b=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||a.encryptionKey;if(void 0===b)throw Object.defineProperty(new g.InvariantError("Missing encryption key for Server Actions"),"__NEXT_ERROR_CODE",{value:"E571",enumerable:!1,configurable:!0});return d=await crypto.subtle.importKey("raw",j(atob(b)),"AES-GCM",!0,["encrypt","decrypt"])}},44721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f={decryptActionBoundArgs:function(){return x},encryptActionBoundArgs:function(){return w}};for(var g in f)Object.defineProperty(c,g,{enumerable:!0,get:f[g]});a.r(55781);let h=a.r(11857),i=a.r(28472),j=a.r(75406),k=a.r(49126),l=a.r(58146),m=a.r(32319),n=a.r(60384),o=(d=a.r(717))&&d.__esModule?d:{default:d},p=new TextEncoder,q=new TextDecoder,r,s;async function t(a,b){let c=await (0,k.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=atob(b),e=d.slice(0,16),f=d.slice(16),g=q.decode(await (0,k.decrypt)(c,(0,k.stringToUint8Array)(e),(0,k.stringToUint8Array)(f)));if(!g.startsWith(a))throw Object.defineProperty(Error("Invalid Server Action payload: failed to decrypt."),"__NEXT_ERROR_CODE",{value:"E191",enumerable:!1,configurable:!0});return g.slice(a.length)}async function u(a,b){let c=await (0,k.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=new Uint8Array(16);m.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(d));let e=(0,k.arrayBufferToString)(d.buffer),f=await (0,k.encrypt)(c,d,p.encode(a+b));return btoa(e+(0,k.arrayBufferToString)(f))}var v=((e=v||{})[e.Ready=0]="Ready",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete",e);let w=o.default.cache(async function a(b,...c){let d=m.workUnitAsyncStorage.getStore(),e=d?(0,m.getCacheSignal)(d):void 0,{clientModules:f}=(0,l.getClientReferenceManifest)(),g=Error();Error.captureStackTrace(g,a);let i=!1,k=d?(0,n.createHangingInputAbortSignal)(d):void 0,o=0;function p(){0===o&&(o=1,null==e||e.beginRead())}function q(){1===o&&(null==e||e.endRead()),o=2}k&&e&&k.addEventListener("abort",p,{once:!0});let s=await (0,j.streamToString)((0,h.renderToReadableStream)(c,f,{filterStackFrame:r,signal:k,onError(a){(null==k?void 0:k.aborted)||i||(i=!0,g.message=a instanceof Error?a.message:String(a))}}),k);if(i)throw q(),g;if(!d)return u(b,s);p();let t=(0,m.getPrerenderResumeDataCache)(d),v=(0,m.getRenderResumeDataCache)(d),w=b+s,x=(null==t?void 0:t.encryptedBoundArgs.get(w))??(null==v?void 0:v.encryptedBoundArgs.get(w));if(x)return x;let y=await u(b,s);return q(),null==t||t.encryptedBoundArgs.set(w,y),y});async function x(a,b){let c,d=await b,e=m.workUnitAsyncStorage.getStore();if(e){let b=(0,m.getCacheSignal)(e),f=(0,m.getPrerenderResumeDataCache)(e),g=(0,m.getRenderResumeDataCache)(e);(c=(null==f?void 0:f.decryptedBoundArgs.get(d))??(null==g?void 0:g.decryptedBoundArgs.get(d)))||(null==b||b.beginRead(),c=await t(a,d),null==b||b.endRead(),null==f||f.decryptedBoundArgs.set(d,c))}else c=await t(a,d);let{edgeRscModuleMapping:f,rscModuleMapping:g}=(0,l.getClientReferenceManifest)();return await (0,i.createFromReadableStream)(new ReadableStream({start(a){switch(a.enqueue(p.encode(c)),null==e?void 0:e.type){case"prerender":case"prerender-runtime":e.renderSignal.aborted?a.close():e.renderSignal.addEventListener("abort",()=>a.close(),{once:!0});break;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":case void 0:return a.close()}}}),{findSourceMapURL:s,serverConsumerManifest:{moduleLoading:null,moduleMap:g,serverModuleMap:(0,l.getServerModuleMap)()}})}},18159,a=>{"use strict";a.s(["Checkbox",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call Checkbox() from the server but Checkbox is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/checkbox.tsx <module evaluation>","Checkbox")},92983,a=>{"use strict";a.s(["Checkbox",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call Checkbox() from the server but Checkbox is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/checkbox.tsx","Checkbox")},65251,a=>{"use strict";a.i(18159);var b=a.i(92983);a.n(b)},38084,a=>{"use strict";a.s(["FormImageUpload",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call FormImageUpload() from the server but FormImageUpload is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/form-image-upload.tsx <module evaluation>","FormImageUpload")},51824,a=>{"use strict";a.s(["FormImageUpload",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call FormImageUpload() from the server but FormImageUpload is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/form-image-upload.tsx","FormImageUpload")},20773,a=>{"use strict";a.i(38084);var b=a.i(51824);a.n(b)},29167,a=>{"use strict";a.s(["LocationPicker",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call LocationPicker() from the server but LocationPicker is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/location-picker.tsx <module evaluation>","LocationPicker")},99357,a=>{"use strict";a.s(["LocationPicker",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call LocationPicker() from the server but LocationPicker is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/location-picker.tsx","LocationPicker")},47281,a=>{"use strict";a.i(29167);var b=a.i(99357);a.n(b)},90550,a=>{"use strict";a.s(["DocumentUpload",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call DocumentUpload() from the server but DocumentUpload is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/document-upload.tsx <module evaluation>","DocumentUpload")},84925,a=>{"use strict";a.s(["DocumentUpload",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call DocumentUpload() from the server but DocumentUpload is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/document-upload.tsx","DocumentUpload")},2200,a=>{"use strict";a.i(90550);var b=a.i(84925);a.n(b)},58544,a=>{"use strict";a.s(["BatchUnitCreator",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call BatchUnitCreator() from the server but BatchUnitCreator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/batch-unit-creator.tsx <module evaluation>","BatchUnitCreator")},3906,a=>{"use strict";a.s(["BatchUnitCreator",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call BatchUnitCreator() from the server but BatchUnitCreator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/batch-unit-creator.tsx","BatchUnitCreator")},36575,a=>{"use strict";a.i(58544);var b=a.i(3906);a.n(b)},57248,a=>{"use strict";a.s(["ExcelImport",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ExcelImport() from the server but ExcelImport is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/excel-import.tsx <module evaluation>","ExcelImport")},613,a=>{"use strict";a.s(["ExcelImport",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ExcelImport() from the server but ExcelImport is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/excel-import.tsx","ExcelImport")},56783,a=>{"use strict";a.i(57248);var b=a.i(613);a.n(b)},8441,a=>{"use strict";a.s(["ConstructionProgress",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ConstructionProgress() from the server but ConstructionProgress is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/construction-progress.tsx <module evaluation>","ConstructionProgress")},3009,a=>{"use strict";a.s(["ConstructionProgress",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ConstructionProgress() from the server but ConstructionProgress is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/construction-progress.tsx","ConstructionProgress")},63298,a=>{"use strict";a.i(8441);var b=a.i(3009);a.n(b)},74093,10778,88316,40089,a=>{"use strict";var b=a.i(7997),c=a.i(37936),d=a.i(44721),e=a.i(16349),f=a.i(38904),g=a.i(55583),h=a.i(43562),i=a.i(65251),j=a.i(35330),k=a.i(73083),l=a.i(45310),m=a.i(19637),n=a.i(18558),o=a.i(13095);async function p(a){let b=await (0,e.createClient)(),c=a.get("id"),d=a.getAll("amenities"),f={project_code:a.get("project_code"),name:a.get("name"),manager_name:a.get("manager_name"),phase_count:Number(a.get("phase_count")),status:a.get("status"),address:a.get("address"),district:a.get("district"),city:a.get("city"),website_url:a.get("website_url"),image_url:a.get("image_url"),latitude:a.get("latitude")?Number(a.get("latitude")):null,longitude:a.get("longitude")?Number(a.get("longitude")):null,start_date:a.get("start_date")?new Date(a.get("start_date")).toISOString():null,delivery_date_planned:a.get("delivery_date_planned")?new Date(a.get("delivery_date_planned")).toISOString():null,delivery_date_actual:a.get("delivery_date_actual")?new Date(a.get("delivery_date_actual")).toISOString():null,ada_no:a.get("ada_no"),parsel_no:a.get("parsel_no"),amenities:d,visibility_type:a.get("visibility_type")||"public",min_broker_level_id:a.get("min_broker_level_id")||null},{error:g}=await b.from("projects").update(f).eq("id",c);return g?(console.error("Update Project Error:",g),{error:"Failed to update project"}):((0,n.revalidatePath)(`/projects/${c}`),(0,n.revalidatePath)("/projects"),{success:!0})}async function q(a){let b=await (0,e.createClient)(),c=a.get("project_id"),d=a.get("unit_category"),f=a.get("type"),g=Number(a.get("count")),h=Number(a.get("start_number"))||1,i=a.get("block")||"A",j=a.get("area_gross")?Number(a.get("area_gross")):null,k=a.get("price")?Number(a.get("price")):0,l=a.get("currency")||"TRY",m=a.get("max_discount_rate")?Number(a.get("max_discount_rate")):0,{data:{user:o}}=await b.auth.getUser();if(!o)return{error:"Unauthorized"};let{data:p}=await b.from("profiles").select("tenant_id").eq("id",o.id).single();if(!p?.tenant_id)return{error:"No tenant found"};let q=a.get("room_areas"),r=[];try{q&&(r=JSON.parse(q))}catch(a){console.error("Failed to parse room_areas:",a)}let s=[];for(let b=0;b<g;b++)s.push({project_id:c,unit_number:`${i}-${h+b}`,unit_category:d,type:f,status:"For Sale",price:k,currency:l,area_gross:j,floor:Math.floor((h+b)/4)+1,max_discount_rate:m,block:i,parking_type:a.get("parking_type")||null,heating_type:a.get("heating_type")||null,has_builtin_kitchen:"true"===a.get("has_builtin_kitchen"),direction:a.get("direction")||null,kitchen_type:a.get("kitchen_type")||null,has_master_bathroom:"true"===a.get("has_master_bathroom"),room_areas:r.length>0?r:null});let{error:t}=await b.from("units").insert(s);return t?(console.error("Batch Create Error:",t),{error:"Failed to create units: "+t.message}):((0,n.revalidatePath)(`/projects/${c}`),{success:!0})}async function r(a,b){let c=await (0,e.createClient)(),{data:{user:d}}=await c.auth.getUser();if(!d)return{error:"Unauthorized"};let{data:f}=await c.from("profiles").select("tenant_id").eq("id",d.id).single();if(!f?.tenant_id)return{error:"No tenant found"};let{error:g}=await c.from("project_broker_access").insert({project_id:a,broker_id:b,tenant_id:f.tenant_id});return g?"23505"===g.code?{error:"Bu broker zaten yetkili."}:{error:"Yetki verilemedi: "+g.message}:((0,n.revalidatePath)(`/projects/${a}`),{success:!0})}async function s(a,b){let c=await (0,e.createClient)(),{error:d}=await c.from("project_broker_access").delete().eq("id",a);return d?{error:"Yetki kaldırılamadı: "+d.message}:((0,n.revalidatePath)(`/projects/${b}`),{success:!0})}async function t(a,b,c){let d=await (0,e.createClient)(),{error:f}=await d.from("construction_stages").insert({project_id:a,name:b,weight:c});return f?{error:"Aşama eklenemedi: "+f.message}:((0,n.revalidatePath)(`/projects/${a}`),{success:!0})}async function u(a,b,c){let d=await (0,e.createClient)(),{error:f}=await d.from("construction_stages").update(c).eq("id",a);return f?{error:"Aşama güncellenemedi: "+f.message}:((0,n.revalidatePath)(`/projects/${b}`),{success:!0})}async function v(a,b){let c=await (0,e.createClient)(),{error:d}=await c.from("construction_stages").delete().eq("id",a);return d?{error:"Aşama silinemedi: "+d.message}:((0,n.revalidatePath)(`/projects/${b}`),{success:!0})}async function w(a,b,c,d){let f,g=await (0,e.createClient)(),{data:h}=await g.from("unit_construction_progress").select("id").eq("unit_id",a).eq("stage_id",b).single();if(h){let{error:a}=await g.from("unit_construction_progress").update({completion_percentage:c,last_updated:new Date().toISOString()}).eq("id",h.id);f=a}else{let{error:d}=await g.from("unit_construction_progress").insert({unit_id:a,stage_id:b,completion_percentage:c});f=d}return f?{error:"İlerleme güncellenemedi: "+f.message}:((0,n.revalidatePath)(`/projects/${d}`),{success:!0})}async function x(a){let b=await (0,e.createClient)(),{data:{user:c}}=await b.auth.getUser();if(!c)return{error:"Unauthorized"};let{data:d}=await b.from("profiles").select("tenant_id").eq("id",c.id).single();if(!d?.tenant_id)return{error:"No tenant found"};let f=a.get("project_id"),g=a.get("file"),h=a.get("document_name"),i=a.get("description");if(!g||!h)return{error:"File and document name are required"};try{let a=g.name.split(".").pop(),e=`${Date.now()}-${Math.random()}.${a}`,j=`project-documents/${f}/${e}`,{error:k}=await b.storage.from("crm-images").upload(j,g);if(k)return console.error("Upload Error:",k),{error:"Failed to upload file"};let{data:l}=b.storage.from("crm-images").getPublicUrl(j),{error:m}=await b.from("project_documents").insert({tenant_id:d.tenant_id,project_id:f,file_name:g.name,file_url:l.publicUrl,file_type:g.type,file_size:g.size,document_name:h,description:i,uploaded_by:c.id});if(m)return console.error("Database Error:",m),{error:"Failed to save document metadata"};return(0,n.revalidatePath)(`/projects/${f}`),{success:!0}}catch(a){return console.error("Upload Document Error:",a),{error:"An error occurred"}}}async function y(a,b){let c=await (0,e.createClient)(),{data:{user:d}}=await c.auth.getUser();if(!d)return{error:"Unauthorized"};let{data:f}=await c.from("project_documents").select("file_url").eq("id",a).single();if(!f)return{error:"Document not found"};let g=f.file_url.split("/crm-images/");if(g.length>1){let a=g[1];await c.storage.from("crm-images").remove([a])}let{error:h}=await c.from("project_documents").delete().eq("id",a);return h?(console.error("Delete Error:",h),{error:"Failed to delete document"}):((0,n.revalidatePath)(`/projects/${b}`),{success:!0})}async function z(a){let b=await (0,e.createClient)(),{data:{user:c}}=await b.auth.getUser();if(!c)return{error:"Unauthorized"};let{data:d}=await b.from("profiles").select("tenant_id").eq("id",c.id).single();if(!d?.tenant_id)return{error:"No tenant found"};let f=a.get("project_id"),g=a.get("file");if(!g)return{error:"File is required"};try{let a=(await g.text()).split("\n").filter(a=>a.trim());if(a.length<2)return{error:"File is empty or invalid"};let e=a[0].split(/[,;\t]/).map(a=>a.trim().toLowerCase()),h=[];for(let b=1;b<a.length;b++){let g=a[b].split(/[,;\t]/).map(a=>a.trim()),i={tenant_id:d.tenant_id,project_id:f,created_by:c.id,currency:"TRY",status:"For Sale"};e.forEach((a,b)=>{let c=g[b];if(c)switch(a){case"unit_number":case"ünite_no":i.unit_number=c;break;case"type":case"tip":i.type=c;break;case"status":case"durum":i.status=c;break;case"price":case"fiyat":i.price=parseFloat(c)||0;break;case"area_gross":case"brüt_alan":case"brut":i.area_gross=parseFloat(c)||null;break;case"floor":case"kat":i.floor=parseInt(c)||null;break;case"block":case"blok":i.block=c}}),i.unit_number&&i.type&&h.push(i)}if(0===h.length)return{error:"No valid units found in file"};let{error:i}=await b.from("units").insert(h);if(i)return console.error("Import Error:",i),{error:"Failed to import units: "+i.message};return(0,n.revalidatePath)(`/projects/${f}`),{success:!0,count:h.length}}catch(a){return console.error("Parse Error:",a),{error:"Failed to parse file"}}}(0,o.ensureServerEntryExports)([p,q,r,s,t,u,v,w]),(0,c.registerServerReference)(p,"4008e159486ad49f4a3b2cba437e57129645cf5e35",null),(0,c.registerServerReference)(q,"40cf871b65ec8b81419c386a142457ccb94eaedfb4",null),(0,c.registerServerReference)(r,"6063c971b8235b2f257774881ea0a1ea4c9ca15e35",null),(0,c.registerServerReference)(s,"60f165ce06c742e604964459bfdfde0304e849e26a",null),(0,c.registerServerReference)(t,"707ed91d928330792837d5af596f508366f37932e4",null),(0,c.registerServerReference)(u,"70118c3530afdd6541fe9bbc311e30982304541cbf",null),(0,c.registerServerReference)(v,"60efea125be467250640a9bd0a743dd66e4e2a0c0d",null),(0,c.registerServerReference)(w,"780cd2e178c73ce105b39ecd5a7db8aed62d7619be",null),a.s(["addBrokerAccess",()=>r,"addConstructionStage",()=>t,"batchCreateUnits",()=>q,"deleteConstructionStage",()=>v,"removeBrokerAccess",()=>s,"updateConstructionStage",()=>u,"updateProject",()=>p,"updateUnitProgress",()=>w],10778),(0,o.ensureServerEntryExports)([x,y]),(0,c.registerServerReference)(x,"40cc57bdc757f11bb59cdf046c52329e668c8a6dfb",null),(0,c.registerServerReference)(y,"60ed7e966bef883a8e92e3ca724b2fcaadf4fd6bb8",null),a.s(["deleteDocument",()=>y,"uploadDocument",()=>x],88316),(0,o.ensureServerEntryExports)([z]),(0,c.registerServerReference)(z,"40f335cd28f9df3873550bdd9747c17678db4ae3b2",null),a.s(["importUnitsFromExcel",()=>z],40089);var A=a.i(66968),B=a.i(84254),C=a.i(58836),D=a.i(69713),E=a.i(98888),F=a.i(84674),G=a.i(95550);let H=(0,a.i(1269).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var I=a.i(89584),J=a.i(83627),K=a.i(95936),L=a.i(20773),M=a.i(47281),N=a.i(2200),O=a.i(36575),P=a.i(56783),Q=a.i(66915),R=a.i(63298),S=a.i(46840);let T=["Yetişkin Havuzu","Güvenlik","Çocuk Yüzme Havuzu","Yürüyüş Parkuru","Fitness","Çocuk oyun parkı","Cafe","Market","Tenis kortu","Basketbol sahası"],U=async function(a){await p(a)};(0,c.registerServerReference)(U,"40b9ecbc578fda0064cb05c43427b3b9027f83ff3a",null);let V=async function(a,b){var[c]=await (0,d.decryptActionBoundArgs)("60abf185ba11e7a76fd5e57dfc124bcbcbfac64595",a);await (0,A.deleteUnit)(b,c)};(0,c.registerServerReference)(V,"60abf185ba11e7a76fd5e57dfc124bcbcbfac64595",null);let W=async function(a,b){var[c]=await (0,d.decryptActionBoundArgs)("604ddfd20025274c62c1cdb188f31aa8bfcf2052bf",a);await y(b,c)};(0,c.registerServerReference)(W,"604ddfd20025274c62c1cdb188f31aa8bfcf2052bf",null);let X=async function(a,b){var[c]=await (0,d.decryptActionBoundArgs)("60b83f1bc9bd98f4c15846ec2b67523ef65fbaf3b0",a);let e=b.get("broker_id");e&&await r(c,e)};(0,c.registerServerReference)(X,"60b83f1bc9bd98f4c15846ec2b67523ef65fbaf3b0",null);let Y=async function(a){var[b,c]=await (0,d.decryptActionBoundArgs)("40a50c17ea55385d60c8c3a97f7063af9117889260",a);await s(b,c)};async function Z({params:a,searchParams:c}){let n=await (0,e.createClient)(),{id:o}=await a,{tab:p}=await c,{data:r}=await n.from("broker_levels").select("*").order("min_sales_count",{ascending:!0}),{data:s,error:y}=await n.from("projects").select("*").eq("id",o).single();if(y||!s)return(0,b.jsxs)("div",{className:"p-8 text-center border border-red-200 bg-red-50 rounded-lg text-red-700",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Proje Yüklenemedi"}),(0,b.jsx)("p",{children:y?.message||"Proje bulunamadı."}),(0,b.jsx)(K.default,{href:"/projects",className:"mt-4 inline-block",children:(0,b.jsx)(f.Button,{variant:"outline",children:"Listeye Dön"})})]});let{data:A,error:Z}=await n.from("team_project_assignments").select(`
            sales_teams(
                id,
                name,
                region,
                office_name,
                team_members(
                    profiles(full_name, role)
                )
            )
        `).eq("project_id",o);Z&&console.warn("Teams could not be fetched (schema might be missing):",Z.message);let{data:$,error:_}=await n.from("project_documents").select("*").eq("project_id",o).order("created_at",{ascending:!1});if($&&$.length>0){let a=[...new Set($.map(a=>a.uploaded_by).filter(Boolean))],{data:b}=await n.from("profiles").select("id, full_name").in("id",a),c=new Map(b?.map(a=>[a.id,a.full_name])||[]);$.forEach(a=>{a.uploader_name=c.get(a.uploaded_by)||"Unknown"})}let{data:aa}=await n.from("units").select("*").eq("project_id",o).order("unit_number",{ascending:!0}),{data:ab}=await n.from("construction_stages").select("*").eq("project_id",o).order("order_index",{ascending:!0}),{data:ac}=await n.from("unit_construction_progress").select("*").in("unit_id",aa?.map(a=>a.id)||[]),{data:ad}=await n.from("project_broker_access").select(`
            id,
            profiles (
                id,
                full_name,
                email
            )
        `).eq("project_id",o),{data:ae}=await n.from("profiles").select("id, full_name, email").eq("tenant_id",s.tenant_id).eq("role","broker").eq("is_active",!0);var af=V.bind(null,(0,d.encryptActionBoundArgs)("60abf185ba11e7a76fd5e57dfc124bcbcbfac64595",o)),ag=W.bind(null,(0,d.encryptActionBoundArgs)("604ddfd20025274c62c1cdb188f31aa8bfcf2052bf",o));return(0,b.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(Q.BackButton,{variant:"outline",label:"Listeye Dön"}),(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Proje Detayları"})]})}),(0,b.jsxs)(k.Tabs,{defaultValue:p||"info",className:"w-full",children:[(0,b.jsxs)(k.TabsList,{children:[(0,b.jsx)(k.TabsTrigger,{value:"info",children:"Proje Bilgileri"}),(0,b.jsxs)(k.TabsTrigger,{value:"units",children:[(0,b.jsx)(I.Home,{className:"w-4 h-4 mr-2"}),"Üniteler",aa&&aa.length>0&&(0,b.jsx)(m.Badge,{variant:"secondary",className:"ml-2",children:aa.length})]}),(0,b.jsxs)(k.TabsTrigger,{value:"documents",children:[(0,b.jsx)(F.FileText,{className:"w-4 h-4 mr-2"}),"Proje Dokümanları",$&&$.length>0&&(0,b.jsx)(m.Badge,{variant:"secondary",className:"ml-2",children:$.length})]}),(0,b.jsxs)(k.TabsTrigger,{value:"teams",children:[(0,b.jsx)(J.Users,{className:"w-4 h-4 mr-2"}),"Satış Ekipleri"]}),(0,b.jsxs)(k.TabsTrigger,{value:"broker-access",children:[(0,b.jsx)(J.Users,{className:"w-4 h-4 mr-2"}),"Broker Erişimi"]}),(0,b.jsxs)(k.TabsTrigger,{value:"construction",children:[(0,b.jsx)(S.Building2,{className:"w-4 h-4 mr-2"}),"Şantiye & İlerleme"]})]}),(0,b.jsx)(k.TabsContent,{value:"broker-access",className:"space-y-4",children:(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{className:"flex flex-row items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)(j.CardTitle,{children:"Özel Broker Erişimi"}),(0,b.jsx)(j.CardDescription,{children:"Bu projenin görünürlüğü 'Gizli' veya 'Seviye Kısıtlı' olsa bile, burada listelenen brokerlar projeyi görebilir."})]})}),(0,b.jsxs)(j.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("form",{action:X.bind(null,(0,d.encryptActionBoundArgs)("60b83f1bc9bd98f4c15846ec2b67523ef65fbaf3b0",o)),className:"flex gap-4 items-end p-4 border rounded-lg bg-muted/30",children:[(0,b.jsxs)("div",{className:"grid gap-2 flex-1",children:[(0,b.jsx)(h.Label,{htmlFor:"broker_id",children:"Broker Seçin"}),(0,b.jsxs)("select",{id:"broker_id",name:"broker_id",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Eklemek için bir broker seçin..."}),ae?.filter(a=>!ad?.some(b=>b.profiles?.id===a.id)).map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.full_name," (",a.email,")"]},a.id))]})]}),(0,b.jsxs)(f.Button,{type:"submit",children:[(0,b.jsx)(B.Plus,{className:"w-4 h-4 mr-2"})," Ekle"]})]}),(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{children:"Broker Adı"}),(0,b.jsx)(l.TableHead,{children:"Email"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"İşlemler"})]})}),(0,b.jsx)(l.TableBody,{children:ad&&ad.length>0?ad.map(a=>(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableCell,{className:"font-medium",children:a.profiles?.full_name}),(0,b.jsx)(l.TableCell,{children:a.profiles?.email}),(0,b.jsx)(l.TableCell,{className:"text-right",children:(0,b.jsx)("form",{action:Y.bind(null,(0,d.encryptActionBoundArgs)("40a50c17ea55385d60c8c3a97f7063af9117889260",a.id,o)),children:(0,b.jsx)(f.Button,{size:"sm",variant:"ghost",children:(0,b.jsx)(H,{className:"h-4 w-4 text-destructive"})})})})]},a.id)):(0,b.jsx)(l.TableRow,{children:(0,b.jsx)(l.TableCell,{colSpan:3,className:"text-center h-24 text-muted-foreground",children:"Bu proje için manuel yetkilendirilmiş broker bulunmuyor."})})})]})]})]})}),(0,b.jsx)(k.TabsContent,{value:"info",className:"space-y-6",children:(0,b.jsxs)("form",{action:U,children:[(0,b.jsx)("input",{type:"hidden",name:"id",value:s.id}),(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Proje Bilgileri"})}),(0,b.jsxs)(j.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Proje Görseli"}),(0,b.jsx)(L.FormImageUpload,{name:"image_url",defaultValue:s.image_url})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"project_code",children:"Proje Kodu"}),(0,b.jsx)(g.Input,{id:"project_code",name:"project_code",defaultValue:s.project_code,placeholder:"Örn: NP4K"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"name",children:"Proje Adı"}),(0,b.jsx)(g.Input,{id:"name",name:"name",defaultValue:s.name,required:!0})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"manager_name",children:"Proje Yöneticisi"}),(0,b.jsx)(g.Input,{id:"manager_name",name:"manager_name",defaultValue:s.manager_name})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"phase_count",children:"Etap Sayısı"}),(0,b.jsx)(g.Input,{id:"phase_count",name:"phase_count",type:"number",defaultValue:s.phase_count})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"status",children:"Proje Durumu"}),(0,b.jsxs)("select",{id:"status",name:"status",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",defaultValue:s.status,children:[(0,b.jsx)("option",{value:"Active",children:"Satışa AÇIK"}),(0,b.jsx)("option",{value:"Planned",children:"Planlanıyor"}),(0,b.jsx)("option",{value:"Completed",children:"KAPALI"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 border-t pt-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"visibility_type",children:"Broker Portali Görünürlüğü"}),(0,b.jsxs)("select",{id:"visibility_type",name:"visibility_type",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",defaultValue:s.visibility_type||"public",children:[(0,b.jsx)("option",{value:"public",children:"Tüm Brokerlara Açık (Public)"}),(0,b.jsx)("option",{value:"level_restricted",children:"Seviye Kısıtlı (Level Based)"}),(0,b.jsx)("option",{value:"private",children:"Gizli / Sadece Davetle (Private)"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Projenin dış brokerlar tarafından nasıl görüleceğini belirler."})]}),(0,b.jsxs)("div",{className:"space-y-2 text-muted-foreground opacity-100",children:[(0,b.jsx)(h.Label,{htmlFor:"min_broker_level_id",children:"Minimum Broker Seviyesi"}),(0,b.jsxs)("select",{id:"min_broker_level_id",name:"min_broker_level_id",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",defaultValue:s.min_broker_level_id||"",children:[(0,b.jsx)("option",{value:"",children:"Seviye Kısıtlaması Yok"}),r?.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.min_sales_count,"+ Satış)"]},a.id))]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Sadece 'Seviye Kısıtlı' modunda geçerlidir."})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"address",children:"Adres"}),(0,b.jsx)(g.Input,{id:"address",name:"address",defaultValue:s.address})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(h.Label,{className:"flex items-center gap-2",children:[(0,b.jsx)(E.MapPin,{className:"w-4 h-4"})," Lokasyon"]}),(0,b.jsx)(M.LocationPicker,{address:s.address?`${s.address}, ${s.district||""}, ${s.city||""}`.trim():"",latitude:s.latitude,longitude:s.longitude}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Lokasyon seçmek için harita ikonuna tıklayın. Seçili lokasyonu görüntülemek için dış bağlantı ikonuna tıklayın."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"district",children:"İlçe"}),(0,b.jsx)(g.Input,{id:"district",name:"district",defaultValue:s.district})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"city",children:"İl"}),(0,b.jsx)(g.Input,{id:"city",name:"city",defaultValue:s.city})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"ada_no",children:"Ada No"}),(0,b.jsx)(g.Input,{id:"ada_no",name:"ada_no",defaultValue:s.ada_no})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"parsel_no",children:"Parsel No"}),(0,b.jsx)(g.Input,{id:"parsel_no",name:"parsel_no",defaultValue:s.parsel_no})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(h.Label,{htmlFor:"website_url",className:"flex items-center gap-2",children:[(0,b.jsx)(C.Globe,{className:"w-4 h-4"})," Proje Web Sitesi"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Input,{id:"website_url",name:"website_url",defaultValue:s.website_url,className:"flex-1"}),s.website_url&&(0,b.jsx)(K.default,{href:s.website_url,target:"_blank",children:(0,b.jsx)(f.Button,{size:"icon",variant:"outline",type:"button",children:(0,b.jsx)(D.ExternalLink,{className:"w-4 h-4"})})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"start_date",children:"Başlama Tarihi"}),(0,b.jsx)(g.Input,{id:"start_date",name:"start_date",type:"date",defaultValue:s.start_date?.split("T")[0]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"delivery_date_planned",children:"Teslim Tarihi (Planlanan)"}),(0,b.jsx)(g.Input,{id:"delivery_date_planned",name:"delivery_date_planned",type:"date",defaultValue:s.delivery_date_planned?.split("T")[0]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"delivery_date_actual",children:"Teslim Tarihi (Gerçekleşen)"}),(0,b.jsx)(g.Input,{id:"delivery_date_actual",name:"delivery_date_actual",type:"date",defaultValue:s.delivery_date_actual?.split("T")[0]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Projedeki Sosyal Alanlar"}),(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 p-4 border rounded-lg bg-muted/30",children:T.map(a=>{let c=s.amenities?.includes(a);return(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Checkbox,{id:`amenity-${a}`,name:"amenities",value:a,defaultChecked:c}),(0,b.jsx)(h.Label,{htmlFor:`amenity-${a}`,className:"text-sm font-normal cursor-pointer",children:a})]},a)})})]}),(0,b.jsx)("div",{className:"flex justify-end pt-4",children:(0,b.jsx)(f.Button,{type:"submit",size:"lg",children:"Değişiklikleri Kaydet"})})]})]})]})}),(0,b.jsx)(k.TabsContent,{value:"units",className:"space-y-4",children:(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.CardTitle,{children:"Proje Üniteleri"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Projeye ait tüm bağımsız bölümleri buradan yönetebilirsiniz."})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(O.BatchUnitCreator,{projectId:s.id,action:q}),(0,b.jsx)(P.ExcelImport,{projectId:s.id,onImport:z})]})]}),(0,b.jsx)(j.CardContent,{children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{className:"w-[100px]",children:"Ünite No"}),(0,b.jsx)(l.TableHead,{className:"w-[120px]",children:"Ünite Türü"}),(0,b.jsx)(l.TableHead,{className:"w-[120px]",children:"Oda Tipi"}),(0,b.jsx)(l.TableHead,{className:"w-[100px]",children:"Durum"}),(0,b.jsx)(l.TableHead,{className:"w-[150px]",children:"Fiyat"}),(0,b.jsx)(l.TableHead,{className:"w-[100px]",children:"Brüt m²"}),(0,b.jsx)(l.TableHead,{className:"w-[80px]",children:"Kat"}),(0,b.jsx)(l.TableHead,{className:"w-[80px]",children:"Blok"}),(0,b.jsx)(l.TableHead,{className:"w-[100px]",children:"İnşaat"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"İşlemler"})]})}),(0,b.jsx)(l.TableBody,{children:aa&&aa.length>0?aa.map(a=>(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableCell,{className:"font-medium",children:a.unit_number}),(0,b.jsx)(l.TableCell,{children:a.unit_category||"-"}),(0,b.jsx)(l.TableCell,{children:a.type}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(m.Badge,{variant:"For Sale"===a.status?"default":"Sold"===a.status?"destructive":"secondary",children:"For Sale"===a.status?"Satılık":"Reserved"===a.status?"Rezerve":"Sold"===a.status?"Satıldı":a.status})}),(0,b.jsx)(l.TableCell,{children:a.price?`${a.price.toLocaleString("tr-TR")} ${a.currency||"TRY"}`:"-"}),(0,b.jsx)(l.TableCell,{children:a.area_gross?`${a.area_gross} m\xb2`:"-"}),(0,b.jsx)(l.TableCell,{children:a.floor||"-"}),(0,b.jsx)(l.TableCell,{children:a.block||"-"}),(0,b.jsx)(l.TableCell,{children:(()=>{let c=ac?.filter(b=>b.unit_id===a.id)||[];if(ab&&ab.length>0){let a=ab.reduce((a,b)=>a+(b.weight||0),0);if(0===a)return"-";let d=0;ab.forEach(b=>{let e=c.find(a=>a.stage_id===b.id);d+=(e?.completion_percentage||0)*(b.weight||0)/a});let e=Math.round(d);return(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-12 h-1.5 bg-muted rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-primary",style:{width:`${e}%`}})}),(0,b.jsxs)("span",{className:"text-[10px] font-medium",children:["%",e]})]})}return"-"})()}),(0,b.jsx)(l.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(K.default,{href:`/inventory/${a.id}`,children:(0,b.jsx)(f.Button,{size:"sm",variant:"outline",children:"Detay"})}),(0,b.jsx)("form",{action:af.bind(null,a.id),children:(0,b.jsx)(f.Button,{size:"sm",variant:"ghost",type:"submit",children:(0,b.jsx)(H,{className:"h-4 w-4 text-destructive"})})})]})})]},a.id)):(0,b.jsx)(l.TableRow,{children:(0,b.jsx)(l.TableCell,{colSpan:8,className:"text-center h-24 text-muted-foreground",children:"Henüz ünite eklenmemiş. Yukarıdaki butonları kullanarak ünite ekleyebilirsiniz."})})})]})})]})}),(0,b.jsx)(k.TabsContent,{value:"documents",className:"space-y-4",children:(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.CardTitle,{children:"Proje Dokümanları"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Projeye ait tüm dokümanları buradan yönetebilirsiniz."})]}),(0,b.jsx)(N.DocumentUpload,{projectId:s.id,onUpload:x})]}),(0,b.jsx)(j.CardContent,{children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{children:"Döküman Adı"}),(0,b.jsx)(l.TableHead,{children:"Açıklama"}),(0,b.jsx)(l.TableHead,{children:"Dosya Tipi"}),(0,b.jsx)(l.TableHead,{children:"Yükleme Tarihi"}),(0,b.jsx)(l.TableHead,{children:"Yükleyen"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"İşlemler"})]})}),(0,b.jsx)(l.TableBody,{children:$&&$.length>0?$.map(a=>(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableCell,{className:"font-medium",children:a.document_name}),(0,b.jsx)(l.TableCell,{className:"max-w-xs truncate",children:a.description||"-"}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(m.Badge,{variant:"outline",children:a.file_type||"Unknown"})}),(0,b.jsx)(l.TableCell,{children:new Date(a.created_at).toLocaleDateString("tr-TR")}),(0,b.jsx)(l.TableCell,{children:a.uploader_name||"Unknown"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(K.default,{href:a.file_url,target:"_blank",children:(0,b.jsx)(f.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(G.Download,{className:"h-4 w-4"})})}),(0,b.jsx)("form",{action:ag.bind(null,a.id),children:(0,b.jsx)(f.Button,{size:"sm",variant:"destructive",type:"submit",children:(0,b.jsx)(H,{className:"h-4 w-4"})})})]})})]},a.id)):(0,b.jsx)(l.TableRow,{children:(0,b.jsx)(l.TableCell,{colSpan:6,className:"text-center h-24 text-muted-foreground",children:"Henüz döküman yüklenmemiş."})})})]})})]})}),(0,b.jsx)(k.TabsContent,{value:"teams",className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[A?.map(a=>(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(j.CardTitle,{className:"text-lg",children:a.sales_teams.name}),(0,b.jsx)(m.Badge,{variant:"outline",children:a.sales_teams.region||"Genel"})]}),(0,b.jsx)(j.CardDescription,{children:a.sales_teams.office_name})]}),(0,b.jsx)(j.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("h4",{className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(J.Users,{className:"w-4 h-4"})," Ekip Üyeleri"]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:a.sales_teams.team_members?.map((a,c)=>(0,b.jsx)(m.Badge,{variant:"secondary",children:a.profiles.full_name},c))})]})})]},a.sales_teams.id)),(!A||0===A.length)&&(0,b.jsx)(j.Card,{className:"col-span-full border-dashed",children:(0,b.jsxs)(j.CardContent,{className:"flex flex-col items-center justify-center p-12 text-muted-foreground",children:[(0,b.jsx)(J.Users,{className:"w-12 h-12 mb-4 opacity-20"}),(0,b.jsx)("p",{children:"Bu projeye henüz bir satış ekibi atanmamış."}),(0,b.jsx)(K.default,{href:"/teams",className:"mt-4",children:(0,b.jsx)(f.Button,{variant:"outline",children:"Ekipleri Yönet"})})]})})]})}),(0,b.jsx)(k.TabsContent,{value:"construction",className:"space-y-4",children:(0,b.jsx)(R.ConstructionProgress,{projectId:o,stages:ab||[],units:aa||[],unitProgress:ac||[],onAddStage:t,onUpdateStage:u,onDeleteStage:v,onUpdateUnitProgress:w})})]})]})}(0,c.registerServerReference)(Y,"40a50c17ea55385d60c8c3a97f7063af9117889260",null),a.s(["$$RSC_SERVER_ACTION_0",0,U,"$$RSC_SERVER_ACTION_1",0,V,"$$RSC_SERVER_ACTION_2",0,W,"$$RSC_SERVER_ACTION_3",0,X,"$$RSC_SERVER_ACTION_4",0,Y,"default",()=>Z,"dynamic",0,"force-dynamic"],74093)}];

//# sourceMappingURL=_cbe7a393._.js.map